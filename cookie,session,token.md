# 쿠키와세션 그리고 토큰
## 쿠키
쿠키는 **공개 가능**한 정보를 **사용자의 브라우저에 저장**시킨다.
서버는 클라이언트의 로그인 요청에 대한 응답을 작성할 때, 클라이언트 측에 **저장하고 싶은 정보를 응답 헤더의 set-cookie** 에 담는다.
이후 클라이언트가 재요청 할 때마다 **저장된 쿠키를 요청 헤더의 cookie 에 담아 보낸다**.
서버는 쿠키에 담긴 정보를 바탕으로 해당 요청의 **클라이언트가 누군지 식별** 할 수 있다.
### 요약
내가 필요한 요청을 쿠키를 통해 서버에 보내고 서버는 내정보를 가지고 있다가 내가 오면 그 쿠키를 다시 나에게줘 내가 했던 요청을 적용 시킨다.
## 세션
총 3가지 방법으로 데이터를 저장시킨다(서버 설정마다 다름)
1. 메모리
2. 하드디스크
3. 데이터베이스
### 특징
1. 모든 정보를 **서버에 저장**함
2. 또한 모든 정보를 저장하고 있기에 **추방,변경등 직접 제어가 가능**함
### 단점
1. 저장 위치는 위와같이 저장이 되는데 **보안이 높을수록 요청 시간이 길어져** 오래 걸린다
2. 하지만 모든 정보를 저장하기 때문에 **돈이 많이 든다**
## 토큰
Authentication = 인증(저는 이런 사람 입니다)  
Authorization = 인가(아 너는 그런 사람이구나 넘어가)
### 특징
1. **서버에 저장 하지않고** 그저 토큰이 유호 한지 안한지만 확인을 한다
2. 토큰은 마침표를 기준으로 **3가지로 나뉜다**(xxxxxxxx.yyyyyyyy.zzzzzzz)
3. 위기준 **x는 header(헤더),y는 payload(페이로드),z는 verify signature(서명)**
4. 페이로드에는 토큰이 **언제부터 어디까지,누구에게,무엇을 공개할지 등**의 데이터가 담겨있다=이것을 **클레임(Claim)**이라고 부른다.
5. 헤더에는 2가지 정보가 들어가는 데 하나는 **type으로 JWT고정**이다
나머지 하나는 alg(알고리즘) 3번 서명을 만드는데 사용되는 **알고리즘울 저장**한다. 여러 암호와 방식을 지정하여 사용가능(ex:HS256(비밀 키를 알고 있는 경우만 서명을 확인),RS256:개인 키로 서명하고 공개 키로 검증)
1. 서명은 **헤더와 페이로드를 모두 암호화** 하면 나오게 된다
### 단점
1. 하지만 서버는 저장한것이 없기 때문에 **제어가 불가능**함
2. 또한 누군가가 토큰을 가져가면 **그것을 방어할 수단**또한 사라짐
### 보완(ex)
1. 만료시간을 짧게 만든 access 토큰과 만료시간을 길게 잡은(약 2주)를 잡아놓은 refresh 토큰을 준다
2. refresh 토큰은 데이터베이스에 저장
3. 유저는 access 토큰이 만료되면 refresh 토큰을 보냄
4. 서버는 그걸 데이터베이스와 대조후 새 access 토큰을 보내는식
## 토큰vs세션
뭐가 더좋은지는 상황에 따라 디르기에 뭐가더 좋다가 없다.
본인이 충분히 부담이 가능하면 세션등을 사용해도 되고 간단하게 만들것이다 하면 토큰으로 하면된다.